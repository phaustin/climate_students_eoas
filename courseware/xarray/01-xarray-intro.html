

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction to Xarray &#8212; Climate Laboratory Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'courseware/xarray/01-xarray-intro';</script>
    <link rel="canonical" href="https://phaustin.github.io/ClimateLaboratoryBook/courseware/xarray/01-xarray-intro.html" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Computations and Masks with Xarray" href="02-computation-masking.html" />
    <link rel="prev" title="Assignment: Insolation and orbital parameters" href="../assignments/assignment6-insolation-orbit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../home.html">
  
  
  
  
  
    <p class="title logo__title">Climate Laboratory Book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../home.html">
                    The Climate Laboratory
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Syllabus</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ugradsyllabus.html">Undergraduate Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gradsyllabus.html">Graduate Syllabus</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Weekly topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../week1_topics.html">Week 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week2_topics.html">Week 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week3_topics.html">Week 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week4_topics.html">Week 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../week7_topics.html">Week 7</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../preamble.html">Preamble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About this Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../who-for.html">Who is the book for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to.html">How to use this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../attribution.html">How to cite and reuse this material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extra_reading.html">Additional resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week1/lab1_models-budgets-fun.html">1. Climate models, the global energy budget, and Fun with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week2/lab2_zero-dim-ebm.html">2. Modeling the global energy budget</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week2/lab2_1_analytical-efolding.html">2.11. Advanced topic: Analytical solution of the global Energy Balance Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week2/lab3_climate-system-models.html">3. The climate system and climate models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week3/lab4_introducing-cesm.html">4. Introducing the Community Earth System Model (CESM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/lab5_climlab-intro.html">5. Building simple climate models using climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/lab6_radiation.html">6. A Brief Review of Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/lab7_elementary-greenhouse.html">7. Elementary greenhouse models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/lab8_sympy-greenhouse.html">8. Advanced topic: Solving the two-layer grey gas model analytically with sympy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/lab9_grey-radiation-climlab.html">9. Grey radiation modeling with climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/lab10_radiative-transfer.html">10. Modeling non-scattering radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/lab11_spectral-bands.html">11. Who needs spectral bands? We do. Some baby steps…</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week5/lab12_radeq.html">12. Radiative Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/lab13_rce.html">13. Radiative-Convective Equilibrium</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week5/lab14_sensitivity-feedback.html">14. Climate sensitivity and feedback</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week5/lab14_2_advanced-sensitivity-feedback.html">14.9. Advanced topic: Climate sensitivity and feedback</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week5/lab15_transient-cesm.html">15. Examing the transient and equilibrium CO<span class="math notranslate nohighlight">\(_2\)</span> response in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/lab16_transient-toy.html">16. Toy models of transient warming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week6/lab17_clouds.html">17. Clouds and cloud feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/lab18_insolation.html">18. Insolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/lab19_orbital.html">19. Orbital variations, insolation, and the ice ages</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week6/lab20_heat-transport.html">20. Heat transport</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week6/lab20_2_advanced-heat-transport.html">20.8. Advanced topic: Heat transport decomposition</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week7/lab21_one-dim-ebm.html">21. The one-dimensional energy balance model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7/lab22_seasonal-cycle.html">22. Modeling the seasonal cycle of surface temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7/lab23_cesm-atmospheric-dynamics.html">23. Atmospheric Dynamics in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7/lab24_numerical-diffusion.html">24. A peek at numerical methods for diffusion models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week8/lab25_albedo-snowball.html">25. Ice-albedo feedback and Snowball Earth in the EBM</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week8/lab25_2_advanced-albedo-feedback.html">25.10. Advanced topic: Ice albedo feedback in the EBM – test2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week8/lab25_3_advanced-snowball-earth.html">25.11. Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../week8/lab26_cesm-coupled-dynamics.html">26. Coupled Dynamics in the CESM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week9/lab27_surface-energy-balance.html">The surface energy balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/lab28_land-ocean-contrast.html">Land-Ocean contrasts under climate change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/lab29_water-water-everywhere.html">Water, water everywhere!</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../about-assignments.html">About the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment1-zero-dim-ebm.html">Assignment: Climate change in the zero-dimensional EBM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment2-cesm-control.html">Assignment: Global average budgets in the CESM pre-industrial control simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment2-cesm-control-hints.html">Additional hints and guidance for CESM budgets assignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment3-simple-clouds.html">Assignment: Clouds in the Leaky Greenhouse Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment4-rcm-feedback.html">Assignment: Feedbacks in the Radiative-Convective Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment5-cesm-climate-change.html">Assignment: Climate change in the CESM simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment6-insolation-orbit.html">Assignment: Insolation and orbital parameters</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">xarray tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction to Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-computation-masking.html">Computations and Masks with Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-enso-xarray.html">Calculating ENSO with Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-dask-arrays-xarray.html">Dask Arrays with Xarray</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../resources/resource_links.html">Project resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docs/feedback_notation.html">Feedback notation for worksheet 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hydrostat.html">Hydrostatic balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hydrostatic_balance.html">Scale heights for typical atmospheric soundings</a></li>

<li class="toctree-l1"><a class="reference internal" href="../multi_layer_equilibrium.html">Radiative equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bayes_lecture.html">What I wish I’d known about statistics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://climhub.phaustin.org/hub/user-redirect/git-pull?repo=https%3A//github.com/phaustin/ClimateLaboratoryBook&urlpath=tree/ClimateLaboratoryBook/content/courseware/xarray/01-xarray-intro.md&branch=jb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/courseware/xarray/01-xarray-intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/courseware/xarray/01-xarray-intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to Xarray</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-dataarray-and-dataset">Introducing the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> and <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creation-of-a-dataarray-object">Creation of a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-a-random-numpy-array">Generate a random numpy array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wrap-the-array-first-attempt">Wrap the array: first attempt</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-dimension-names">Assign dimension names</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataarray-with-named-coordinates">Create a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with named Coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-time-and-space-coordinates">Make time and space coordinates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-the-dataarray-with-complete-coordinate-info">Initialize the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with complete coordinate info</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-useful-attributes">Set useful attributes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes-are-not-preserved-by-default">Attributes are not preserved by default!</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset-a-container-for-dataarrays-with-shared-coordinates">The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>: a container for <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>s with shared coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-pressure-dataarray-using-the-same-coordinates">Create a pressure <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> using the same coordinates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataset-object">Create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data-variables-and-coordinates-in-a-dataset">Access Data variables and Coordinates in a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-and-selection-by-coordinate-values">Subsetting and selection by coordinate values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-like-selection">NumPy-like selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-with-sel">Selecting with <code class="docutils literal notranslate"><span class="pre">.sel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximate-selection-and-interpolation">Approximate selection and interpolation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-sampling">Nearest-neighbor sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation">Interpolation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slicing-along-coordinates">Slicing along coordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-more-selection-method-loc">One more selection method: <code class="docutils literal notranslate"><span class="pre">.loc</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-netcdf-data">Opening netCDF data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-netcdf-data-with-xr-open-dataset">Access netCDF data with <code class="docutils literal notranslate"><span class="pre">xr.open_dataset</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-the-dataset">Subsetting the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-operations">Aggregation operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-xarray">Plotting with Xarray</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-visualization-with-plot">Simple visualization with <code class="docutils literal notranslate"><span class="pre">.plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-plot">Customizing the plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-2d-data">Plotting 2D data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-next">What’s next?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><img alt="xarray Logo" src="http://xarray.pydata.org/en/stable/_static/dataset-diagram-logo.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-to-xarray">
<h1>Introduction to Xarray<a class="headerlink" href="#introduction-to-xarray" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h2>
<p>This notebook will introduce the basics of gridded, labeled data with Xarray. Since Xarray introduces additional abstractions on top of plain arrays of data, our goal is to show why these abstractions are useful and how they frequently lead to simpler, more robust code.</p>
<p>We’ll cover these topics:</p>
<ol class="arabic simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, one of the core object types in Xarray</p></li>
<li><p>Understand how to use named coordinates and metadata in a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code></p></li>
<li><p>Combine individual <code class="docutils literal notranslate"><span class="pre">DataArrays</span></code> into a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, the other core object type in Xarray</p></li>
<li><p>Subset, slice, and interpolate the data using named coordinates</p></li>
<li><p>Open netCDF data using XArray</p></li>
<li><p>Basic subsetting and aggregation of a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></p></li>
<li><p>Brief introduction to plotting with Xarray</p></li>
</ol>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">#</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="xref myst">NumPy Basics</span></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="xref myst">Intermediate NumPy</span></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with indexing and slicing arrays</p></td>
</tr>
<tr class="row-even"><td><p><span class="xref myst">NumPy Broadcasting</span></p></td>
<td><p>Helpful</p></td>
<td><p>Familiar with array arithmetic and broadcasting</p></td>
</tr>
<tr class="row-odd"><td><p><span class="xref myst">Introduction to Pandas</span></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with labeled data</p></td>
</tr>
<tr class="row-even"><td><p><span class="xref myst">Datetime</span></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with time formats and the <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> object</p></td>
</tr>
<tr class="row-odd"><td><p><span class="xref myst">Understanding of NetCDF</span></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with metadata structure</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 40 minutes</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<p>Simmilar to <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">np</span></code>; <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">pd</span></code>; you may often encounter <code class="docutils literal notranslate"><span class="pre">xarray</span></code> imported within a shortened namespace as <code class="docutils literal notranslate"><span class="pre">xr</span></code>. <code class="docutils literal notranslate"><span class="pre">pythia_datasets</span></code> provides example data for us to work with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">pythia_datasets</span> <span class="kn">import</span> <span class="n">DATASETS</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="introducing-the-dataarray-and-dataset">
<h2>Introducing the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> and <code class="docutils literal notranslate"><span class="pre">Dataset</span></code><a class="headerlink" href="#introducing-the-dataarray-and-dataset" title="Permalink to this headline">#</a></h2>
<p>Xarray expands on the capabilities on NumPy arrays, providing a lot of streamlined data manipulation. It is similar in that respect to Pandas, but whereas Pandas excels at working with tabular data, Xarray is focused on N-dimensional arrays of data (i.e. grids). Its interface is based largely on the netCDF data model (variables, attributes, and dimensions), but it goes beyond the traditional netCDF interfaces to provide functionality similar to netCDF-java’s <a class="reference external" href="https://docs.unidata.ucar.edu/netcdf-java/current/userguide/common_data_model_overview.html">Common Data Model (CDM)</a>.</p>
<section id="creation-of-a-dataarray-object">
<h3>Creation of a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> object<a class="headerlink" href="#creation-of-a-dataarray-object" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> is one of the basic building blocks of Xarray (see docs <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataarray">here</a>). It provides a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>-like object that expands to provide two critical pieces of functionality:</p>
<ol class="arabic simple">
<li><p>Coordinate names and values are stored with the data, making slicing and indexing much more powerful</p></li>
<li><p>It has a built-in container for attributes</p></li>
</ol>
<p>Here we’ll initialize a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> object by wrapping a plain NumPy array, and explore a few of its properties.</p>
<section id="generate-a-random-numpy-array">
<h4>Generate a random numpy array<a class="headerlink" href="#generate-a-random-numpy-array" title="Permalink to this headline">#</a></h4>
<p>For our first example, we’ll just create a random array of “temperature” data in units of Kelvin:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="mi">283</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="wrap-the-array-first-attempt">
<h4>Wrap the array: first attempt<a class="headerlink" href="#wrap-the-array-first-attempt" title="Permalink to this headline">#</a></h4>
<p>Now we create a basic <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> just by passing our plain <code class="docutils literal notranslate"><span class="pre">data</span></code> as input:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
<p>Note two things:</p>
<ol class="arabic simple">
<li><p>Xarray generates some basic dimension names for us (<code class="docutils literal notranslate"><span class="pre">dim_0</span></code>, <code class="docutils literal notranslate"><span class="pre">dim_1</span></code>, <code class="docutils literal notranslate"><span class="pre">dim_2</span></code>). We’ll improve this with better names in the next example.</p></li>
<li><p>Wrapping the numpy array in a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> gives us a rich display in the notebook! (Try clicking the array symbol to expand or collapse the view)</p></li>
</ol>
</section>
<section id="assign-dimension-names">
<h4>Assign dimension names<a class="headerlink" href="#assign-dimension-names" title="Permalink to this headline">#</a></h4>
<p>Much of the power of Xarray comes from making use of named dimensions. So let’s add some more useful names! We can do that by passing an ordered list of names using the keyword argument <code class="docutils literal notranslate"><span class="pre">dims</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
<p>This is already improved upon from a NumPy array, because we have names for each of the dimensions (or axes in NumPy parlance). Even better, we can take arrays representing the values for the coordinates for each of these dimensions and associate them with the data when we create the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>. We’ll see this in the next example.</p>
</section>
</section>
<section id="create-a-dataarray-with-named-coordinates">
<h3>Create a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with named Coordinates<a class="headerlink" href="#create-a-dataarray-with-named-coordinates" title="Permalink to this headline">#</a></h3>
<section id="make-time-and-space-coordinates">
<h4>Make time and space coordinates<a class="headerlink" href="#make-time-and-space-coordinates" title="Permalink to this headline">#</a></h4>
<p>Here we will use <span class="xref myst">Pandas</span> to create an array of <span class="xref myst">datetime data</span>, which we will then use to create a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with a named coordinate <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">times</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll also create arrays to represent sample longitude and latitude:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-the-dataarray-with-complete-coordinate-info">
<h4>Initialize the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with complete coordinate info<a class="headerlink" href="#initialize-the-dataarray-with-complete-coordinate-info" title="Permalink to this headline">#</a></h4>
<p>When we create the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> instance, we pass in the arrays we just created:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-useful-attributes">
<h4>Set useful attributes<a class="headerlink" href="#set-useful-attributes" title="Permalink to this headline">#</a></h4>
<p>…and while we’re at it, we can also set some attribute metadata:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;kelvin&#39;</span>
<span class="n">temp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;air_temperature&#39;</span>

<span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="attributes-are-not-preserved-by-default">
<h4>Attributes are not preserved by default!<a class="headerlink" href="#attributes-are-not-preserved-by-default" title="Permalink to this headline">#</a></h4>
<p>Notice what happens if we perform a mathematical operaton with the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>: the coordinate values persist, but the attributes are lost. This is done because it is very challenging to know if the attribute metadata is still correct or appropriate after arbitrary arithmetic operations.</p>
<p>To illustrate this, we’ll do a simple unit conversion from Kelvin to Celsius:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp_in_celsius</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="n">temp_in_celsius</span>
</pre></div>
</div>
</div>
</div>
<p>For an in-depth discussion of how Xarray handles metadata, start in the Xarray docs <a class="reference external" href="http://xarray.pydata.org/en/stable/getting-started-guide/faq.html#approach-to-metadata">here</a>.</p>
</section>
</section>
<section id="the-dataset-a-container-for-dataarrays-with-shared-coordinates">
<h3>The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>: a container for <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>s with shared coordinates<a class="headerlink" href="#the-dataset-a-container-for-dataarrays-with-shared-coordinates" title="Permalink to this headline">#</a></h3>
<p>Along with <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, the other key object type in Xarray is the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>: a dictionary-like container that holds one or more <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>s, which can also optionally share coordinates (see docs <a class="reference external" href="http://xarray.pydata.org/en/stable/user-guide/data-structures.html#dataset">here</a>).</p>
<p>The most common way to create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object is to load data from a file (see <span class="xref myst">below</span>). Here, instead, we will create another <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> and combine it with our <code class="docutils literal notranslate"><span class="pre">temp</span></code> data.</p>
<p>This will illustrate how the information about common coordinate axes is used.</p>
<section id="create-a-pressure-dataarray-using-the-same-coordinates">
<h4>Create a pressure <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> using the same coordinates<a class="headerlink" href="#create-a-pressure-dataarray-using-the-same-coordinates" title="Permalink to this headline">#</a></h4>
<p>This code mirrors how we created the <code class="docutils literal notranslate"><span class="pre">temp</span></code> object above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pressure_data</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">pressure_data</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">times</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">pressure</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hPa&#39;</span>
<span class="n">pressure</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;air_pressure&#39;</span>

<span class="n">pressure</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-dataset-object">
<h4>Create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object<a class="headerlink" href="#create-a-dataset-object" title="Permalink to this headline">#</a></h4>
<p>Each <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> in our <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> needs a name!</p>
<p>The most straightforward way to create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> with our <code class="docutils literal notranslate"><span class="pre">temp</span></code> and <code class="docutils literal notranslate"><span class="pre">pressure</span></code> arrays is to pass a dictionary using the keyword argument <code class="docutils literal notranslate"><span class="pre">data_vars</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">data_vars</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Temperature&#39;</span><span class="p">:</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">&#39;Pressure&#39;</span><span class="p">:</span> <span class="n">pressure</span><span class="p">})</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object <code class="docutils literal notranslate"><span class="pre">ds</span></code> is aware that both data arrays sit on the same coordinate axes.</p>
</section>
<section id="access-data-variables-and-coordinates-in-a-dataset">
<h4>Access Data variables and Coordinates in a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code><a class="headerlink" href="#access-data-variables-and-coordinates-in-a-dataset" title="Permalink to this headline">#</a></h4>
<p>We can pull out any of the individual <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> objects in a few different ways.</p>
<p>Using the “dot” notation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">Pressure</span>
</pre></div>
</div>
</div>
</div>
<p>… or using dictionary access like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll return to the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object when we start loading data from files.</p>
</section>
</section>
</section>
<section id="subsetting-and-selection-by-coordinate-values">
<h2>Subsetting and selection by coordinate values<a class="headerlink" href="#subsetting-and-selection-by-coordinate-values" title="Permalink to this headline">#</a></h2>
<p>Much of the power of labeled coordinates comes from the ability to select data based on coordinate names and values, rather than array indices. We’ll explore this briefly here.</p>
<section id="numpy-like-selection">
<h3>NumPy-like selection<a class="headerlink" href="#numpy-like-selection" title="Permalink to this headline">#</a></h3>
<p>Suppose we want to extract all the spatial data for one single date: January 2, 2018. It’s possible to achieve that with NumPy-like index selection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indexed_selection</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># Index 1 along axis 0 is the time slice we want...</span>
<span class="n">indexed_selection</span>
</pre></div>
</div>
</div>
</div>
<p>HOWEVER, notice that this requires us (the user / programmer) to have <strong>detailed knowledge</strong> of the order of the axes and the meaning of the indices along those axes!</p>
<p><em><strong>Named coordinates free us from this burden…</strong></em></p>
</section>
<section id="selecting-with-sel">
<h3>Selecting with <code class="docutils literal notranslate"><span class="pre">.sel()</span></code><a class="headerlink" href="#selecting-with-sel" title="Permalink to this headline">#</a></h3>
<p>We can instead select data based on coordinate values using the <code class="docutils literal notranslate"><span class="pre">.sel()</span></code> method, which takes one or more named coordinate(s) as keyword argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">named_selection</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2018-01-02&#39;</span><span class="p">)</span>
<span class="n">named_selection</span>
</pre></div>
</div>
</div>
</div>
<p>We got the same result, but</p>
<ul class="simple">
<li><p>we didn’t have to know anything about how the array was created or stored</p></li>
<li><p>our code is agnostic about how many dimensions we are dealing with</p></li>
<li><p>the intended meaning of our code is much clearer!</p></li>
</ul>
</section>
<section id="approximate-selection-and-interpolation">
<h3>Approximate selection and interpolation<a class="headerlink" href="#approximate-selection-and-interpolation" title="Permalink to this headline">#</a></h3>
<p>With time and space data, we frequently want to sample “near” the coordinate points in our dataset. Here are a few simple ways to achieve that.</p>
<section id="nearest-neighbor-sampling">
<h4>Nearest-neighbor sampling<a class="headerlink" href="#nearest-neighbor-sampling" title="Permalink to this headline">#</a></h4>
<p>Suppose we want to sample the nearest datapoint within 2 days of date <code class="docutils literal notranslate"><span class="pre">2018-01-07</span></code>. Since the last day on our <code class="docutils literal notranslate"><span class="pre">time</span></code> axis is <code class="docutils literal notranslate"><span class="pre">2018-01-05</span></code>, this is well-posed.</p>
<p><code class="docutils literal notranslate"><span class="pre">.sel</span></code> has the flexibility to perform nearest neighbor sampling, taking an optional tolerance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2018-01-07&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>where we see that <code class="docutils literal notranslate"><span class="pre">.sel</span></code> indeed pulled out the data for date <code class="docutils literal notranslate"><span class="pre">2018-01-05</span></code>.</p>
</section>
<section id="interpolation">
<h4>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">#</a></h4>
<p>Suppose we want to extract a timeseries for Boulder (40°N, 105°W). Since <code class="docutils literal notranslate"><span class="pre">lon=-105</span></code> is <em>not</em> a point on our longitude axis, this requires interpolation between data points.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.interp()</span></code> method (see the docs <a class="reference external" href="http://xarray.pydata.org/en/stable/interpolation.html">here</a>) works similarly to <code class="docutils literal notranslate"><span class="pre">.sel()</span></code>. Using <code class="docutils literal notranslate"><span class="pre">.interp()</span></code>, we can interpolate to any latitude/longitude location:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lon</span><span class="o">=-</span><span class="mi">105</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>Xarray’s interpolation functionality requires the <a href="https://scipy.org/">SciPy</a> package!</p>
</div>
</section>
</section>
<section id="slicing-along-coordinates">
<h3>Slicing along coordinates<a class="headerlink" href="#slicing-along-coordinates" title="Permalink to this headline">#</a></h3>
<p>Frequently we want to select a range (or <em>slice</em>) along one or more coordinate(s). We can achieve this by passing a Python <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice">slice</a> object to <code class="docutils literal notranslate"><span class="pre">.sel()</span></code>, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-01-03&#39;</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">),</span> <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>The calling sequence for <code>slice</code> always looks like <code>slice(start, stop[, step])</code>, where <code>step</code> is optional.</p>
</div>
<p>Notice how the length of each coordinate axis has changed due to our slicing.</p>
</section>
<section id="one-more-selection-method-loc">
<h3>One more selection method: <code class="docutils literal notranslate"><span class="pre">.loc</span></code><a class="headerlink" href="#one-more-selection-method-loc" title="Permalink to this headline">#</a></h3>
<p>All of these operations can also be done within square brackets on the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-01-02&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>This is sort of in between the NumPy-style selection</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,:]</span>
</pre></div>
</div>
<p>and the fully label-based selection using <code class="docutils literal notranslate"><span class="pre">.sel()</span></code></p>
<p>With <code class="docutils literal notranslate"><span class="pre">.loc</span></code>, we make use of the coordinate <em>values</em>, but lose the ability to specify the <em>names</em> of the various dimensions. Instead, the slicing must be done in the correct order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">:</span><span class="s1">&#39;2018-01-03&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">110</span><span class="p">:</span><span class="o">-</span><span class="mi">70</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>One advantage of using <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is that we can use NumPy-style slice notation like <code class="docutils literal notranslate"><span class="pre">25:45</span></code>, rather than the more verbose <code class="docutils literal notranslate"><span class="pre">slice(25,45)</span></code>. But of course that also works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">:</span><span class="s1">&#39;2018-01-03&#39;</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="o">-</span><span class="mi">110</span><span class="p">:</span><span class="o">-</span><span class="mi">70</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>What <em>doesn’t</em> work is passing the slices in a different order:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will generate an error</span>
<span class="c1"># temp.loc[-110:-70, 25:45,&#39;2018-01-01&#39;:&#39;2018-01-03&#39;]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="opening-netcdf-data">
<h2>Opening netCDF data<a class="headerlink" href="#opening-netcdf-data" title="Permalink to this headline">#</a></h2>
<p>With its close ties to the netCDF data model, Xarray also supports netCDF as a first-class file format. This means it has easy support for opening netCDF datasets, so long as they conform to some of Xarray’s limitations (such as 1-dimensional coordinates).</p>
<section id="access-netcdf-data-with-xr-open-dataset">
<h3>Access netCDF data with <code class="docutils literal notranslate"><span class="pre">xr.open_dataset</span></code><a class="headerlink" href="#access-netcdf-data-with-xr-open-dataset" title="Permalink to this headline">#</a></h3>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>Here we’re getting the data from Project Pythia’s custom library of example data, which we already imported above with <code>from pythia_datasets import DATASETS</code>. The <code>DATASETS.fetch()</code> method will automatically download and cache our example data file <code>NARR_19930313_0000.nc</code> locally.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;NARR_19930313_0000.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once we have a valid path to a data file that Xarray knows how to read, we can open it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="subsetting-the-dataset">
<h3>Subsetting the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code><a class="headerlink" href="#subsetting-the-dataset" title="Permalink to this headline">#</a></h3>
<p>Our call to <code class="docutils literal notranslate"><span class="pre">xr.open_dataset()</span></code> above returned a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object that we’ve decided to call <code class="docutils literal notranslate"><span class="pre">ds</span></code>. We can then pull out individual fields:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">isobaric1</span>
</pre></div>
</div>
</div>
</div>
<p>(recall that we can also use dictionary syntax like <code class="docutils literal notranslate"><span class="pre">ds['isobaric1']</span></code> to do the same thing)</p>
<p><code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s also support much of the same subsetting operations as <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>, but will perform the operation on all data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">isobaric1</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">)</span>
<span class="n">ds_1000</span>
</pre></div>
</div>
</div>
</div>
<p>And further subsetting to a single <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_1000</span><span class="o">.</span><span class="n">Temperature_isobaric</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="aggregation-operations">
<h3>Aggregation operations<a class="headerlink" href="#aggregation-operations" title="Permalink to this headline">#</a></h3>
<p>Not only can you use the named dimensions for manual slicing and indexing of data, but you can also use it to control aggregation operations, like <code class="docutils literal notranslate"><span class="pre">std</span></code> (standard deviation):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u_winds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;u-component_of_wind_isobaric&#39;</span><span class="p">]</span>
<span class="n">u_winds</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition alert alert-info">
<p class="admonition-title">Info</p>
<p>Aggregation methods for Xarray objects operate over the named coordinate dimension(s) specified by keyword argument <code>dim</code>. Compare to NumPy, where aggregations operate over specified numbered <code>axes</code>.</p>
</div>
<p>Using the sample dataset, we can calculate the mean temperature profile (temperature as a function of pressure) over Colorado within this dataset. For this exercise, consider the bounds of Colorado to be:</p>
<ul class="simple">
<li><p>x: -182km to 424km</p></li>
<li><p>y: -1450km to -990km</p></li>
</ul>
<p>(37°N to 41°N and 102°W to 109°W projected to Lambert Conformal projection coordinates)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">Temperature_isobaric</span>
<span class="n">co_temps</span> <span class="o">=</span> <span class="n">temps</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">182</span><span class="p">,</span> <span class="mi">424</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">1450</span><span class="p">,</span> <span class="o">-</span><span class="mi">990</span><span class="p">))</span>
<span class="n">prof</span> <span class="o">=</span> <span class="n">co_temps</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">prof</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plotting-with-xarray">
<h2>Plotting with Xarray<a class="headerlink" href="#plotting-with-xarray" title="Permalink to this headline">#</a></h2>
<p>Another major benefit of using labeled data structures is that they enable automated plotting with sensible axis labels.</p>
<section id="simple-visualization-with-plot">
<h3>Simple visualization with <code class="docutils literal notranslate"><span class="pre">.plot()</span></code><a class="headerlink" href="#simple-visualization-with-plot" title="Permalink to this headline">#</a></h3>
<p>Much like we saw in <span class="xref myst">Pandas</span>, Xarray includes an interface to <span class="xref myst">Matplotlib</span> that we can access through the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method of every <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>.</p>
<p>For quick and easy data exploration, we can just call <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> without any modifiers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Here Xarray has generated a line plot of the temperature data against the coordinate variable <code class="docutils literal notranslate"><span class="pre">isobaric</span></code>. Also the metadata are used to auto-generate axis labels and units.</p>
</section>
<section id="customizing-the-plot">
<h3>Customizing the plot<a class="headerlink" href="#customizing-the-plot" title="Permalink to this headline">#</a></h3>
<p>As in Pandas, the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method is mostly just a wrapper to Matplotlib, so we can customize our plot in familiar ways.</p>
<p>In this air temperature profile example, we would like to make two changes:</p>
<ul class="simple">
<li><p>swap the axes so that we have isobaric levels on the y (vertical) axis of the figure</p></li>
<li><p>make pressure decrease upward in the figure, so that up is up</p></li>
</ul>
<p>A few keyword arguments to our <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> call will take care of this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prof</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;isobaric1&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-2d-data">
<h3>Plotting 2D data<a class="headerlink" href="#plotting-2d-data" title="Permalink to this headline">#</a></h3>
<p>In the example above, the <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method produced a line plot.</p>
<p>What if we call <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> on a 2D array?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temps</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">isobaric1</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Xarray has recognized that the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> object calling the plot method has two coordinate variables, and generates a 2D plot using the <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code> method from Matplotlib.</p>
<p>In this case, we are looking at air temperatures on the 1000 hPa isobaric surface over North America. We could of course improve this figure by using <span class="xref myst">Cartopy</span> to handle the map projection and geographic features!</p>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<p>Xarray brings the joy of Pandas-style labeled data operations to N-dimensional data. As such, it has become a central workhorse in the geoscience community for the analysis of gridded datasets. Xarray allows us to open self-describing NetCDF files and make full use of the coordinate axes, labels, units, and other metadata. By making use of labeled coordinates, our code is often easier to write, easier to read, and more robust.</p>
<section id="what-s-next">
<h3>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">#</a></h3>
<p>Additional notebooks to appear in this section will go into more detail about</p>
<ul class="simple">
<li><p>arithemtic and broadcasting with Xarray data structures</p></li>
<li><p>using “group by” operations</p></li>
<li><p>remote data access with OpenDAP</p></li>
<li><p>more advanced visualization including map integration with Cartopy</p></li>
</ul>
</section>
</section>
<section id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Permalink to this headline">#</a></h2>
<p>This notebook was adapated from material in <a class="reference external" href="https://unidata.github.io/python-training/workshop/XArray/xarray-and-cf/">Unidata’s Python Training</a>.</p>
<p>The best resource for Xarray is the <a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray documentation</a>. See in particular</p>
<ul class="simple">
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/getting-started-guide/why-xarray.html">Why Xarray</a></p></li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/getting-started-guide/quick-overview.html#">Quick overview</a></p></li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/gallery.html">Example gallery</a></p></li>
</ul>
<p>Another excellent resource is this <a class="reference external" href="https://xarray-contrib.github.io/xarray-tutorial/">Xarray Tutorial collection</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./courseware/xarray"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../assignments/assignment6-insolation-orbit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Assignment: Insolation and orbital parameters</p>
      </div>
    </a>
    <a class="right-next"
       href="02-computation-masking.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Computations and Masks with Xarray</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-dataarray-and-dataset">Introducing the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> and <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creation-of-a-dataarray-object">Creation of a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-a-random-numpy-array">Generate a random numpy array</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wrap-the-array-first-attempt">Wrap the array: first attempt</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-dimension-names">Assign dimension names</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataarray-with-named-coordinates">Create a <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with named Coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-time-and-space-coordinates">Make time and space coordinates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-the-dataarray-with-complete-coordinate-info">Initialize the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> with complete coordinate info</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-useful-attributes">Set useful attributes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes-are-not-preserved-by-default">Attributes are not preserved by default!</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset-a-container-for-dataarrays-with-shared-coordinates">The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>: a container for <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>s with shared coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-pressure-dataarray-using-the-same-coordinates">Create a pressure <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> using the same coordinates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataset-object">Create a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> object</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#access-data-variables-and-coordinates-in-a-dataset">Access Data variables and Coordinates in a <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-and-selection-by-coordinate-values">Subsetting and selection by coordinate values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-like-selection">NumPy-like selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-with-sel">Selecting with <code class="docutils literal notranslate"><span class="pre">.sel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximate-selection-and-interpolation">Approximate selection and interpolation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-sampling">Nearest-neighbor sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolation">Interpolation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slicing-along-coordinates">Slicing along coordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-more-selection-method-loc">One more selection method: <code class="docutils literal notranslate"><span class="pre">.loc</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#opening-netcdf-data">Opening netCDF data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-netcdf-data-with-xr-open-dataset">Access netCDF data with <code class="docutils literal notranslate"><span class="pre">xr.open_dataset</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#subsetting-the-dataset">Subsetting the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregation-operations">Aggregation operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-xarray">Plotting with Xarray</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-visualization-with-plot">Simple visualization with <code class="docutils literal notranslate"><span class="pre">.plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-the-plot">Customizing the plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-2d-data">Plotting 2D data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-next">What’s next?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian Rose
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>