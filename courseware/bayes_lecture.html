

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>What I wish I’d known about statistics &#8212; Climate Laboratory Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'courseware/bayes_lecture';</script>
    <link rel="canonical" href="https://phaustin.github.io/ClimateLaboratoryBook/courseware/bayes_lecture.html" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="../references.html" />
    <link rel="prev" title="Radiative equilibrium" href="multi_layer_equilibrium.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
    <p class="title logo__title">Climate Laboratory Book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    The Climate Laboratory
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Syllabus</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ugradsyllabus.html">Undergraduate Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gradsyllabus.html">Graduate Syllabus</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Weekly topics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week1_topics.html">Week 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2_topics.html">Week 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3_topics.html">Week 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4_topics.html">Week 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7_topics.html">Week 7</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preamble.html">Preamble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../who-for.html">Who is the book for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to.html">How to use this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../attribution.html">How to cite and reuse this material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extra_reading.html">Additional resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week1/lab1_models-budgets-fun.html">1. Climate models, the global energy budget, and Fun with Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="week2/lab2_zero-dim-ebm.html">2. Modeling the global energy budget</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="week2/lab2_1_analytical-efolding.html">2.11. Advanced topic: Analytical solution of the global Energy Balance Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="week2/lab3_climate-system-models.html">3. The climate system and climate models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week3/lab4_introducing-cesm.html">4. Introducing the Community Earth System Model (CESM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="week3/lab5_climlab-intro.html">5. Building simple climate models using climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="week3/lab6_radiation.html">6. A Brief Review of Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="week3/lab7_elementary-greenhouse.html">7. Elementary greenhouse models</a></li>
<li class="toctree-l1"><a class="reference internal" href="week3/lab8_sympy-greenhouse.html">8. Advanced topic: Solving the two-layer grey gas model analytically with sympy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week4/lab9_grey-radiation-climlab.html">9. Grey radiation modeling with climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="week4/lab10_radiative-transfer.html">10. Modeling non-scattering radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="week4/lab11_spectral-bands.html">11. Who needs spectral bands? We do. Some baby steps…</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week5/lab12_radeq.html">12. Radiative Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="week5/lab13_rce.html">13. Radiative-Convective Equilibrium</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="week5/lab14_sensitivity-feedback.html">14. Climate sensitivity and feedback</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="week5/lab14_2_advanced-sensitivity-feedback.html">14.9. Advanced topic: Climate sensitivity and feedback</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="week5/lab15_transient-cesm.html">15. Examing the transient and equilibrium CO<span class="math notranslate nohighlight">\(_2\)</span> response in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="week5/lab16_transient-toy.html">16. Toy models of transient warming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week6/lab17_clouds.html">17. Clouds and cloud feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="week6/lab18_insolation.html">18. Insolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="week6/lab19_orbital.html">19. Orbital variations, insolation, and the ice ages</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="week6/lab20_heat-transport.html">20. Heat transport</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="week6/lab20_2_advanced-heat-transport.html">20.8. Advanced topic: Heat transport decomposition</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week7/lab21_one-dim-ebm.html">21. The one-dimensional energy balance model</a></li>
<li class="toctree-l1"><a class="reference internal" href="week7/lab22_seasonal-cycle.html">22. Modeling the seasonal cycle of surface temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="week7/lab23_cesm-atmospheric-dynamics.html">23. Atmospheric Dynamics in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="week7/lab24_numerical-diffusion.html">24. A peek at numerical methods for diffusion models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="week8/lab25_albedo-snowball.html">25. Ice-albedo feedback and Snowball Earth in the EBM</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="week8/lab25_2_advanced-albedo-feedback.html">25.10. Advanced topic: Ice albedo feedback in the EBM – test2</a></li>
<li class="toctree-l2"><a class="reference internal" href="week8/lab25_3_advanced-snowball-earth.html">25.11. Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="week8/lab26_cesm-coupled-dynamics.html">26. Coupled Dynamics in the CESM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9 Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week9/lab27_surface-energy-balance.html">The surface energy balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="week9/lab28_land-ocean-contrast.html">Land-Ocean contrasts under climate change</a></li>
<li class="toctree-l1"><a class="reference internal" href="week9/lab29_water-water-everywhere.html">Water, water everywhere!</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about-assignments.html">About the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment1-zero-dim-ebm.html">Assignment: Climate change in the zero-dimensional EBM</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment2-cesm-control.html">Assignment: Global average budgets in the CESM pre-industrial control simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment2-cesm-control-hints.html">Additional hints and guidance for CESM budgets assignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment3-simple-clouds.html">Assignment: Clouds in the Leaky Greenhouse Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment4-rcm-feedback.html">Assignment: Feedbacks in the Radiative-Convective Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment5-cesm-climate-change.html">Assignment: Climate change in the CESM simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignments/assignment6-insolation-orbit.html">Assignment: Insolation and orbital parameters</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">xarray tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="xarray/01-xarray-intro.html">Introduction to Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray/02-computation-masking.html">Computations and Masks with Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray/03-enso-xarray.html">Calculating ENSO with Xarray</a></li>
<li class="toctree-l1"><a class="reference internal" href="xarray/04-dask-arrays-xarray.html">Dask Arrays with Xarray</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../resources/resource_links.html">Project resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extra notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../docs/feedback_notation.html">Feedback notation for worksheet 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="hydrostat.html">Hydrostatic balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="hydrostatic_balance.html">Scale heights for typical atmospheric soundings</a></li>

<li class="toctree-l1"><a class="reference internal" href="multi_layer_equilibrium.html">Radiative equilibrium</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">What I wish I’d known about statistics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://climhub.phaustin.org/hub/user-redirect/git-pull?repo=https%3A//github.com/phaustin/ClimateLaboratoryBook&urlpath=tree/ClimateLaboratoryBook/content/courseware/bayes_lecture.md&branch=jb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/courseware/bayes_lecture.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/courseware/bayes_lecture.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>What I wish I’d known about statistics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-is-a-subtle-concept">Probability is a subtle concept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-theorem">Bayes theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frank-harrell-on-bayes">Frank Harrell on Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-about-probability-of-precipitation">What about probability of precipitation?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-linear-regression-two-ways">Case study: linear regression two ways</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-first-following-hogg-et-al-2010">Frequentist first, following Hogg et al., 2010</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-math-following-fleshman-2019">The math, following: Fleshman, 2019</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood">Maximum likelihood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-this-up">Code this up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-it-to-find-theta-0-theta-1">Use it to find <span class="math notranslate nohighlight">\(\theta_0, \theta_1\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-create-200-simulated-measurements-using-the-model">First create 200 simulated measurements using the model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data-with-the-true-regression-line">Plot the data with the true regression line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-true-and-estimated-green-regression-lines">Compare the true and estimated (green) regression lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-bootstrap-resampling-to-estimate-confidence-intervals">Use bootstrap resampling to estimate confidence intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-100-different-regression-lines">Plot 100 different regression lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-resampled-theta-0-and-theta-1">Histogram resampled <span class="math notranslate nohighlight">\(\theta_0\)</span> and <span class="math notranslate nohighlight">\(\theta_1\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-wrong-with-this-workflow">What’s wrong with this workflow?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-2-the-bayesian-version">Take 2: The Bayesian version</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-do-about-p-text-proposition-the-prior-probability">What to do about <span class="math notranslate nohighlight">\(p(\text{proposition})\)</span> – the prior probability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-solve-this-integral">How to solve this integral?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-this-using-pymc3">Code this using pymc3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#well-that-seemed-complicated-but-worth-it">Well, that seemed complicated – but worth it?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bottom-line">Bottom line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coda-an-example-of-the-debate-on-bayesian-model-comparison">Coda:  An example of the debate on Bayesian model comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading-all-books-available-online-through-the-ubc-library">Further reading – all books available online through the UBC library</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="what-i-wish-i-d-known-about-statistics">
<h1>What I wish I’d known about statistics<a class="headerlink" href="#what-i-wish-i-d-known-about-statistics" title="Permalink to this headline">#</a></h1>
<section id="probability-is-a-subtle-concept">
<h2>Probability is a subtle concept<a class="headerlink" href="#probability-is-a-subtle-concept" title="Permalink to this headline">#</a></h2>
<p>Money quote:  “I must premiss that we, all of us, use this word [“probability”] with a degree of laxity which corrupts and rots our reasoning to a degree that very few of us are at all awake to.” <a class="reference external" href="https://philpapers.org/rec/BURIUW">Charles S. Pierce, 1910</a></p>
<p><a class="reference external" href="https://www.aps.org/publications/apsnews/200907/physicshistory.cfm">Fermat-Pascal letters (1654)</a></p>
<p><a class="reference external" href="https://www.lesswrong.com/posts/RTt59BtFLqQbsSiqd/a-history-of-bayes-theorem">Laplace and Bayes (1754)</a></p>
<p><a class="reference external" href="https://plato.stanford.edu/entries/probability-interpret/#KolProCal">Kolmogorov Axioms (1933)</a>:</p>
<p>i)  0 ≤ p(E) ≤ 1.</p>
<p>ii) the certain event has probability 1</p>
<p>iii) The probability of the union of mutually exclusive events is the sum of the probabilities of the individual events.</p>
<p>All of these interpretations are consistent with these axioms:</p>
<ul>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#ClaPro">3.1 Classical Probability</a></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#LogPro">3.2 Logical/Evidential Probability</a></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#SubPro">3.3 Subjective Probability</a></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#FreInt">3.4 Frequency Interpretations</a></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#ProInt">3.5 Propensity Interpretations</a></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#BesSysInt">3.6 Best-System Interpretations</a></li>
 </ul></li>
 <li><a href="https://plato.stanford.edu/entries/probability-interpret/#ConFutPro">4. Conclusion: Future Prospects?</a>
<ul></section>
<section id="bayes-theorem">
<h2>Bayes theorem<a class="headerlink" href="#bayes-theorem" title="Permalink to this headline">#</a></h2>
<p>Bayes theorem gives the formula for computing conditional probabilities.  This formula applies regardless of your definition of probability, as long as it obeys Kolmogorov’s axioms.</p>
<p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4818954/">A famous example</a></p>
</section>
<section id="frank-harrell-on-bayes">
<h2><a class="reference external" href="https://www.fharrell.com/post/journey/">Frank Harrell on Bayes</a><a class="headerlink" href="#frank-harrell-on-bayes" title="Permalink to this headline">#</a></h2>
<p>If you tossed a coin 100 times resulting in 60 heads, would you rather know the probability of getting &gt; 59 heads out of 100 tosses if the coin happened to be fair, or the probability it is fair given exactly 60 heads? The frequentist approach is alluring because of the minimal work in carrying out a test of the null hypothesis θ=½. But the Bayesian approach provides a direct answer to the second question, and requires you to think. What is an “unfair” coin? Is it θ outside of [0.49, 0.51]? What is the world view of coins, e.g., is someone likely to provide a coin that is easily detectable as unfair because its θ=0.6? Was the coin chosen at random or handed to us?</p>
<p>and for the <a class="reference external" href="https://baezortega.github.io/2018/05/28/robust-correlation/">correlation coefficient</a> the statements would be something like:</p>
<p><strong>Bayes</strong>: According to the model, the correlation coefficient is between -0.83 and -0.98 with 99% probability</p>
<p><strong>Frequentist</strong>: According to the test, we are 95% confident that the correlation coefficient has a value somewhere between -0.51 and -0.99; we don’t really know if this interval contains the value, but if we could repeat this analysis on infinite different samples, we would be wrong just 5% of the time!</p>
</section>
<section id="what-about-probability-of-precipitation">
<h2>What about probability of precipitation?<a class="headerlink" href="#what-about-probability-of-precipitation" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.weather.gov/media/zhu/ZHU_Training_Page/Met_Tutorials/Forecasters_Reference_Book_1997.pdf">UK Met. Office forecaster guidance (pdf p. 141)</a></p></li>
</ul>
<p><strong>11.1.1 Interpretation of probabilities</strong></p>
<p>Probabilities can be interpreted in two ways:</p>
<p>(i) Relative frequency interpretation.</p>
<p>(ii) Subjective interpretation.</p>
<p>UK Met. Office continued:</p>
<p>Thus consider a ‘probability of precipitation (PoP) forecast of 30%’:</p>
<p>(i) Relative interpretation: the present meteorological situation, observed on a large number
of occasions, would give rise to precipitation on 30% of the time.</p>
<p>(ii) Subjective interpretation: the forecaster’s judgment is that the odds against
precipitation are 7 to 3 (odds against no precipitation being 3 to 7). Generally, if p is the
probability, the odds against the event are: (1/p - 1) to 1.  (Ed. note – see <a class="reference external" href="https://en.wikipedia.org/wiki/Hartley_(unit)">hartleys and decibans</a> )</p>
<p>(iii) The subjective interpretation gives a practical way of thinking about probabilities.</p>
<p><strong>So what’s a graduate student to do?</strong></p>
</section>
<section id="case-study-linear-regression-two-ways">
<h2>Case study: linear regression two ways<a class="headerlink" href="#case-study-linear-regression-two-ways" title="Permalink to this headline">#</a></h2>
<section id="frequentist-first-following-hogg-et-al-2010">
<h3>Frequentist first, following <a class="reference external" href="https://arxiv.org/abs/1008.4686">Hogg et al., 2010</a><a class="headerlink" href="#frequentist-first-following-hogg-et-al-2010" title="Permalink to this headline">#</a></h3>
<p>“It is a miracle with which we hope everyone reading this is familiar that if you have a set of two-dimensional points (x, y) that depart from a perfect, narrow, straight line y = m x + b only by the addition of Gaussian distributed noise of known amplitudes in the y direction only, then the maximum-likelihood or best-fit line for the points has a slope m and intercept b that can be obtained justifiably by a perfectly linear matrix-algebra operation known as “weighted linear least-square fitting”. This miracle deserves contemplation.”</p>
</section>
</section>
<section id="the-math-following-fleshman-2019">
<h2>The math, following: <a class="reference external" href="https://towardsdatascience.com/linear-regression-91eeae7d6a2e">Fleshman, 2019</a><a class="headerlink" href="#the-math-following-fleshman-2019" title="Permalink to this headline">#</a></h2>
<p>The generating process:</p>
<div class="math notranslate nohighlight">
\[
y = \theta_1 x + \theta_0 + \epsilon
\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon\)</span> is normally distributed with mean <span class="math notranslate nohighlight">\(\mu=0\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>This means that the conditional (frequentist) probability that we make an observation <span class="math notranslate nohighlight">\(y\)</span> given <span class="math notranslate nohighlight">\(x\)</span> is to:</p>
<div class="math notranslate nohighlight">
\[
p\left(y | x ; \theta_{0}, \theta_{1}, \sigma^{2}\right)=\frac{1}{\sqrt{2 \pi \sigma^{2}}} e^{\frac{-\left(y-(\theta_{1} x + \theta_{0})\right)^{2}}{2 \sigma^{2}}}
\]</div>
<p>Since the data points are assumed to be independent, their probabilities multiply, and we define the <strong>likelihood</strong> of observing the data given the parameters <span class="math notranslate nohighlight">\((\theta_0,\theta_1,\sigma)\)</span> as:
$<span class="math notranslate nohighlight">\(
L_{X}\left(\theta_{0}, \theta_{1}, \sigma^{2}\right)=\frac{1}{\sqrt{2 \pi \sigma^{2}}} \prod_{(x, y) \in X} e^{\frac{-\left(y-(\theta_{1} x +\theta_{0})\right)^{2}}{2 \sigma^{2}}}
\)</span>$</p>
</section>
<section id="maximum-likelihood">
<h2>Maximum likelihood<a class="headerlink" href="#maximum-likelihood" title="Permalink to this headline">#</a></h2>
<p>Solve this for the set of parameters that give the <strong>maximum likelihood</strong> by taking the <span class="math notranslate nohighlight">\(\log\)</span> and finding the maximum by setting the derivative = 0 and solving for <span class="math notranslate nohighlight">\((\theta_0, \theta_1)\)</span>.  This gives you the usual relationship for the slope and intercept in terms of the data statistics (<span class="math notranslate nohighlight">\(\overline{x}\)</span>,<span class="math notranslate nohighlight">\(\overline{y}\)</span>).  Note that we don’t need to know <span class="math notranslate nohighlight">\(\sigma\)</span>, because we’re assuming it’s constant.</p>
<div class="math notranslate nohighlight">
\[
l_{X}\left(\theta_{0}, \theta_{1}, \sigma^{2}\right)=\log \left[\frac{1}{\sqrt{2 \pi \sigma^{2}}} \prod_{(x, y) \in X} e^{\frac{-\left(y-\left(\theta_{1} x+\theta_{0}\right)\right)^{2}}{2 \sigma^{2}}}\right]
\]</div>
<div class="math notranslate nohighlight">
\[
=-\log (\sqrt{2 \pi \sigma^{2}})-\frac{1}{2 \sigma^{2}} \sum_{(x, y) \in X}\left[y-\left(\theta_{1} x+\theta_{0}\right)\right]^{2}
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{y}=\theta_{1} x+\theta_{0}
\]</div>
<div class="math notranslate nohighlight">
\[
\theta_{0}=\overline{y}-\theta_{1} \overline{x}
\]</div>
<div class="math notranslate nohighlight">
\[
\theta_{1}=\frac{\sum_{i}^{n}\left(x_{i}-\overline{x}\right)\left(y_{i}-\overline{y}\right)}{\sum_{i}^{n}\left(x_{i}-\overline{x}\right)^{2}}
\]</div>
</section>
<section id="code-this-up">
<h2>Code this up<a class="headerlink" href="#code-this-up" title="Permalink to this headline">#</a></h2>
<p>A couple of lines of python</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">def</span> <span class="nf">find_line</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the slope and intercept&quot;&quot;&quot;</span>
    
    <span class="c1"># number of points</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="c1"># calculate means</span>
    <span class="n">x_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">y_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
        
    <span class="c1"># calculate slope</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">num</span> <span class="o">+=</span> <span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_bar</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">y_bar</span><span class="p">)</span>
        <span class="n">denom</span> <span class="o">+=</span> <span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_bar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="n">denom</span>
    
    <span class="c1"># calculate intercept</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">y_bar</span> <span class="o">-</span> <span class="n">slope</span><span class="o">*</span><span class="n">x_bar</span>
    
    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-it-to-find-theta-0-theta-1">
<h2>Use it to find <span class="math notranslate nohighlight">\(\theta_0, \theta_1\)</span><a class="headerlink" href="#use-it-to-find-theta-0-theta-1" title="Permalink to this headline">#</a></h2>
<section id="first-create-200-simulated-measurements-using-the-model">
<h3>First create 200 simulated measurements using the model<a class="headerlink" href="#first-create-200-simulated-measurements-using-the-model" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">true_intercept</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">true_slope</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">true_sigma</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="c1"># y = a + b*x</span>
<span class="n">true_regression_line</span> <span class="o">=</span> <span class="n">true_intercept</span> <span class="o">+</span> <span class="n">true_slope</span> <span class="o">*</span> <span class="n">x</span>
<span class="c1"># add noise</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">true_regression_line</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">true_sigma</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-the-data-with-the-true-regression-line">
<h2>Plot the data with the true regression line<a class="headerlink" href="#plot-the-data-with-the-true-regression-line" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Generated data and underlying model&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sampled data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">true_regression_line</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true regression line&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-the-true-and-estimated-green-regression-lines">
<h2>Compare the true and estimated (green) regression lines<a class="headerlink" href="#compare-the-true-and-estimated-green-regression-lines" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">find_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">fit_y</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit_y</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-bootstrap-resampling-to-estimate-confidence-intervals">
<h2>Use bootstrap resampling to estimate confidence intervals<a class="headerlink" href="#use-bootstrap-resampling-to-estimate-confidence-intervals" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">draw_bs_pairs_linreg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform pairs bootstrap for linear regression.&quot;&quot;&quot;</span>

    <span class="c1"># Set up array of indices to sample from: inds</span>
    <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="c1"># Initialize replicates: bs_slope_reps, bs_intercept_reps</span>
    <span class="n">bs_slope_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">bs_intercept_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># Generate replicates</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">bs_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">inds</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">))</span>
        <span class="n">bs_x</span><span class="p">,</span> <span class="n">bs_y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">bs_inds</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">bs_inds</span><span class="p">]</span>
        <span class="c1">#</span>
        <span class="c1"># use np.polyfit for order 1 linear model</span>
        <span class="c1">#</span>
        <span class="n">bs_slope_reps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bs_intercept_reps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">bs_x</span><span class="p">,</span> <span class="n">bs_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bs_slope_reps</span><span class="p">,</span> <span class="n">bs_intercept_reps</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-100-different-regression-lines">
<h2>Plot 100 different regression lines<a class="headerlink" href="#plot-100-different-regression-lines" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">slopes</span><span class="p">,</span> <span class="n">intercepts</span> <span class="o">=</span> <span class="n">draw_bs_pairs_linreg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">the_slope</span><span class="p">,</span><span class="n">the_intercept</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">slopes</span><span class="p">,</span><span class="n">intercepts</span><span class="p">):</span>
    <span class="n">fit_y</span> <span class="o">=</span> <span class="n">the_intercept</span> <span class="o">+</span> <span class="n">the_slope</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fit_y</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="histogram-resampled-theta-0-and-theta-1">
<h2>Histogram resampled <span class="math notranslate nohighlight">\(\theta_0\)</span> and <span class="math notranslate nohighlight">\(\theta_1\)</span><a class="headerlink" href="#histogram-resampled-theta-0-and-theta-1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">slopes</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;slopes&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">intercepts</span><span class="p">);</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;intercepts&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="what-s-wrong-with-this-workflow">
<h2>What’s wrong with this workflow?<a class="headerlink" href="#what-s-wrong-with-this-workflow" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>No way to introduce uncertainty in x</p></li>
<li><p>Unrealistically simple uncertainty in y (constant <span class="math notranslate nohighlight">\(\sigma\)</span>)</p></li>
<li><p>Can’t make statements as frequentists about uncertainty in <span class="math notranslate nohighlight">\(\theta_0, \theta_1\)</span></p></li>
<li><p>Can’t deal with outliers (robust regression)</p></li>
</ol>
</section>
<section id="take-2-the-bayesian-version">
<h2>Take 2: The Bayesian version<a class="headerlink" href="#take-2-the-bayesian-version" title="Permalink to this headline">#</a></h2>
<p>Start with Bayes theorem, given the logical/subjective definition of probability:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0826425b-30e7-4629-9576-d6e3f38febb9">
<span class="eqno">(6)<a class="headerlink" href="#equation-0826425b-30e7-4629-9576-d6e3f38febb9" title="Permalink to this equation">#</a></span>\[\begin{align}
\underbrace{p(\text{proposition} | data)}_{\text{posterior probability}} &amp; \propto 
  \underbrace{p(data | \text{proposition} )}_{likelihood} \times
  \underbrace{p(\text{proposition})}_{\text{prior probability}}
\end{align}\]</div>
<p>The likelhood is exactly the same as the frequentist version:</p>
<div class="math notranslate nohighlight">
\[
p(y | \theta_{0}, \theta_{1}, \sigma^{2} ) \propto \left[\frac{1}{\sqrt{2 \pi \sigma^{2}}} \prod_{(x, y) \in X} e^{\frac{-\left(y-\left(\theta_{1} x+\theta_{0}\right)\right)^{2}}{2 \sigma^{2}}}\right]
\]</div>
<p>Note that the Bayesian version makes clear that the likelihood is a function of the data for a fixed set
of generating function parameters.</p>
</section>
<section id="what-to-do-about-p-text-proposition-the-prior-probability">
<h2>What to do about <span class="math notranslate nohighlight">\(p(\text{proposition})\)</span> – the prior probability<a class="headerlink" href="#what-to-do-about-p-text-proposition-the-prior-probability" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>Take <span class="math notranslate nohighlight">\(p(\theta_1)\)</span> and <span class="math notranslate nohighlight">\(p(\theta_0)\)</span> as normally distributed with mean=0 and <span class="math notranslate nohighlight">\(\sigma = 20\)</span></p></li>
<li><p>Take <span class="math notranslate nohighlight">\(p(\sigma)\)</span> as <a class="reference external" href="https://docs.pymc.io/api/distributions/continuous.html#pymc3.distributions.continuous.HalfCauchy">Halfcauchy</a> with <span class="math notranslate nohighlight">\(\beta=10\)</span></p></li>
<li><p>Again, assume independence, so prior is <span class="math notranslate nohighlight">\(p(\theta_1) \times p(\theta_0) \times p(\sigma)\)</span></p></li>
</ol>
<p>Essentially, we want to “let the data speak” so these are quite flat distributions that don’t put any real preconditions on acceptable values for <span class="math notranslate nohighlight">\(\theta_0, \theta_1, \sigma\)</span>.</p>
<p>So Bayes rule says:</p>
<div class="math notranslate nohighlight">
\[
p( \theta_{0}, \theta_{1}, \sigma^{2} | y ) \propto \left[\frac{1}{\sqrt{2 \pi \sigma^{2}}} \prod_{(x, y) \in X} e^{\frac{-\left(y-\left(\theta_{1} x+\theta_{0}\right)\right)^{2}}{2 \sigma^{2}}}\right] \times p(\theta_1) \times p(\theta_0) \times p(\sigma)
\]</div>
<p>and we can get, for example the pdf of <span class="math notranslate nohighlight">\(\sigma^2\)</span> by marginalization:</p>
<div class="math notranslate nohighlight">
\[
p(\sigma^{2}) \propto \int \int p( \theta_{0}, \theta_{1}, \sigma^{2} | y )\, d \theta_0 \, d \theta_1
\]</div>
</section>
<section id="how-to-solve-this-integral">
<h2>How to solve this integral?<a class="headerlink" href="#how-to-solve-this-integral" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://arxiv.org/pdf/1206.1901.pdf">Hamiltonian Markov Chain Montecarlo</a></p>
<p>A (very) fancy version of naive Monte Carlo integration:</p>
<a class="reference internal image-reference" href="../_images/naive_mc_integration.png"><img alt="../_images/naive_mc_integration.png" src="../_images/naive_mc_integration.png" style="width: 80%;" /></a>
</section>
<section id="code-this-using-pymc3">
<h2>Code this using pymc3<a class="headerlink" href="#code-this-using-pymc3" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymc3</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span> <span class="c1"># model specifications in PyMC3 are wrapped in a with-statement</span>
    <span class="c1"># Define priors</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    
    <span class="c1"># Define likelihood</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> 
                        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Inference!</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span> <span class="c1"># draw 3000 posterior samples using NUTS sampling</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">axes</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">100</span><span class="p">:],</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">generating_fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">pm</span><span class="o">.</span><span class="n">plot_posterior_predictive_glm</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">lm</span><span class="o">=</span><span class="n">generating_fun</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
                              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;posterior predictive regression lines&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">true_regression_line</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;true regression line&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Posterior predictive regression lines&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="well-that-seemed-complicated-but-worth-it">
<h2>Well, that seemed complicated – but worth it?<a class="headerlink" href="#well-that-seemed-complicated-but-worth-it" title="Permalink to this headline">#</a></h2>
<p>Advantages:</p>
<ol class="arabic simple">
<li><p>Estimate of <span class="math notranslate nohighlight">\(\sigma\)</span></p></li>
<li><p>Distributions instead of single numbers for <span class="math notranslate nohighlight">\(\theta_0\)</span> and <span class="math notranslate nohighlight">\(\theta_1\)</span></p></li>
<li><p>Actual (Bayesian) uncertainty estimates for all three parameters</p></li>
<li><p>We can check the model against new data (“posterior predictive checks”)</p></li>
<li><p>Flexible approach generalizes to any generating function we can write in
terms of distributions.</p>
<ol class="arabic simple">
<li><p>Example:  <a class="reference external" href="https://docs.pymc.io/notebooks/GLM-robust.html">Robust regression</a></p></li>
<li><p>Example: <a class="reference external" href="https://baezortega.github.io/2018/05/28/robust-correlation/">Robust correlation</a></p></li>
<li><p>Example: <a class="reference external" href="https://docs.pymc.io/nb_examples/index.html">the pymc3 gallery</a></p></li>
</ol>
</li>
</ol>
</section>
<section id="bottom-line">
<h2>Bottom line<a class="headerlink" href="#bottom-line" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Frequentists – data-oriented, controlled clinical trials with preregistration, lab scientists</p>
<ul>
<li><p>all about the sample space</p></li>
</ul>
</li>
<li><p>Bayesians – more model oriented, often interested in parameter estimation, understanding the
data generating process (i.e., our tribe for many in EOAS)</p></li>
<li><p>All of this is distinct from null hypothesis testing/p-values/Bayes factors, which
when used naively have created replication issues in some research communities.
Pithy summary from Gelman: <a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/signif4.pdf">The difference between significant and insignificant is not statistcially significant</a></p></li>
<li><p>In 1983 I needed <a class="reference external" href="https://docs.pymc.io/notebooks/GLM-hierarchical.html">Hierarchical Bayesian Regression</a>, I was too early by about a decade.</p></li>
<li><p>Bayesian updating via Bayes rule, and the logical/subjective interpretation of probability is closely connected to machine learning</p></li>
</ul>
</section>
<section id="coda-an-example-of-the-debate-on-bayesian-model-comparison">
<h2>Coda:  An example of the debate on Bayesian model comparison<a class="headerlink" href="#coda-an-example-of-the-debate-on-bayesian-model-comparison" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.dropbox.com/s/3vw85dkr506yxag/to_bayes_or_not.pdf?dl=0">To Bayes or not to Bayes</a> – Scales and Sneider (1997)</p></li>
<li><p><a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/philosophy.pdf">Gelman and Shalizi’s answer to those issues</a> – posterior predictive checking</p></li>
</ul>
</section>
<section id="further-reading-all-books-available-online-through-the-ubc-library">
<h2>Further reading – all books available online through the UBC library<a class="headerlink" href="#further-reading-all-books-available-online-through-the-ubc-library" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.oreilly.com/library/view/statistical-rethinking/9781482253481/?ar">Statistical rethinking</a></p>
<ul>
<li><p>Great read by the Richard McElreath, director of the Max Planck Institute for Evolutionary Anthropology – well written and very accessible – nice treatment on the connection between statistics and information theory</p></li>
<li><p><a class="reference external" href="https://github.com/pymc-devs/resources">SR and other python source code for stats texts</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.degruyter.com/viewbooktoc/product/459330">Statistics, data mining and machine learning in astronomy</a></p>
<ul>
<li><p>Lots of pertinent examples from 4 astronomers – closely related to our typical research problems</p></li>
<li><p><a class="reference external" href="https://github.com/astroML/astroML">SDMLA github repository</a></p></li>
<li><p>Related article by one of the co-authors:</p>
<ul>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1411.5018.pdf">Frequentism and Bayesianism: A python-driven primer, Jake Vanderplas 2014</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference external" href="http://gw2jh3xr2c.search.serialssolutions.com/?sid=sersol&amp;SS_jc=TC_034362911&amp;title=Bayesian%20Analysis%20with%20Python%20-%20Second%20Edition">Bayesian analysis with python</a></p>
<ul>
<li><p>Best intro to pymc3</p></li>
<li><p><a class="reference external" href="https://github.com/aloctavodia/BAP">BAP source code</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1008.4686">Hogg et al. Fitting a model to data</a>  – motivation for the regression example in this talk – read the footnotes</p></li>
<li><p><a class="reference external" href="https://arxiv.org/pdf/1205.4446v1.pdf">Hogg et al. on conditional probability</a> – pdfs have units!</p></li>
<li><p><a class="reference external" href="https://statmodeling.stat.columbia.edu/">Gelman’s blog</a>  – <a class="reference external" href="https://statmodeling.stat.columbia.edu/2015/01/27/perhaps-merely-accident-history-skeptics-subjectivists-alike-strain-gnat-prior-distribution-swallowing-camel-likelihood/">a representative post</a></p></li>
<li><p><a class="reference external" href="http://hoggresearch.blogspot.com/">David Hogg’s blog</a> – <a class="reference external" href="http://hoggresearch.blogspot.com/2019/09/how-to-model-empirical-abundance-space.html">a representative post</a></p></li>
<li><p>Galleys of the 2nd edition of Kevin Murphy’s “Machine Learing: A probabilistic perspective”.  Good advanced undergrad grad textbook with great appendices:  <a class="reference external" href="https://www.dropbox.com/s/nf3lwlohsg07u7w/murphy_pm1.pdf?dl=0">murphy_pm1.pdf</a>.  <a class="reference external" href="https://github.com/probml/pyprobml">python code</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./courseware"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="multi_layer_equilibrium.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Radiative equilibrium</p>
      </div>
    </a>
    <a class="right-next"
       href="../references.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-is-a-subtle-concept">Probability is a subtle concept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-theorem">Bayes theorem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frank-harrell-on-bayes">Frank Harrell on Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-about-probability-of-precipitation">What about probability of precipitation?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-study-linear-regression-two-ways">Case study: linear regression two ways</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequentist-first-following-hogg-et-al-2010">Frequentist first, following Hogg et al., 2010</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-math-following-fleshman-2019">The math, following: Fleshman, 2019</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood">Maximum likelihood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-this-up">Code this up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-it-to-find-theta-0-theta-1">Use it to find <span class="math notranslate nohighlight">\(\theta_0, \theta_1\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-create-200-simulated-measurements-using-the-model">First create 200 simulated measurements using the model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data-with-the-true-regression-line">Plot the data with the true regression line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-true-and-estimated-green-regression-lines">Compare the true and estimated (green) regression lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-bootstrap-resampling-to-estimate-confidence-intervals">Use bootstrap resampling to estimate confidence intervals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-100-different-regression-lines">Plot 100 different regression lines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-resampled-theta-0-and-theta-1">Histogram resampled <span class="math notranslate nohighlight">\(\theta_0\)</span> and <span class="math notranslate nohighlight">\(\theta_1\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-s-wrong-with-this-workflow">What’s wrong with this workflow?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-2-the-bayesian-version">Take 2: The Bayesian version</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-do-about-p-text-proposition-the-prior-probability">What to do about <span class="math notranslate nohighlight">\(p(\text{proposition})\)</span> – the prior probability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-solve-this-integral">How to solve this integral?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-this-using-pymc3">Code this using pymc3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#well-that-seemed-complicated-but-worth-it">Well, that seemed complicated – but worth it?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bottom-line">Bottom line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coda-an-example-of-the-debate-on-bayesian-model-comparison">Coda:  An example of the debate on Bayesian model comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading-all-books-available-online-through-the-ubc-library">Further reading – all books available online through the UBC library</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian Rose
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>